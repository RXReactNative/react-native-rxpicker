{"version":3,"sources":["../../../src/core/diff_rsp/RXScrollPicker.js"],"names":["React","Component","StyleSheet","View","Text","PixelRatio","ScrollView","PropTypes","RXConfigArray","RXPickerStyle","px","get","DEFAULT_CONTAINER_HEIGHT","variables","mtdBorderColorDark","store","mtdVSpacingL","RXScrollPicker","constructor","props","data","initialize","state","targetItemHeight","containerHeight","containerRef","scrollers","list","proportion","value","length","TypeError","offsetCount","placeholderList","map","scrollItem","tmp","concat","push","apply","unshift","componentDidMount","getUIData","then","resizeContainerHeight","setState","uiData","forEach","item","index","scrollTo","catch","e","console","log","componentWillReceiveProps","nextProps","setTimeout","element","accurateHeight","maxCount","count","Promise","resolve","reject","toCheck","measure","ret","x","y","width","height","left","top","needToReset","minHeight","maxHeight","Math","floor","rect","locateIndicator","createElement","style","styles","indicator","pointerEvents","indicatorMask","bottom","borderBottomWidth","borderBottomColor","borderTopWidth","borderTopColor","scrollIndex","targetItemIndex","animated","scrollProper","onScroll","scrollHeight","onChange","scrollListLength","newScrollHeight","min","max","quotient","parseInt","String","halfHeight","render","ref","el","container","contentStyle","key","proportionWrapper","flex","Number","c","scroller","scrollEventThrottle","showsVerticalScrollIndicator","contentContainerStyle","scrollerContentContainer","nativeEvent","contentOffset","targetItem","onLayout","layout","ceil","renderItem","targetItemContent","numberOfLines","label","propTypes","arrayOf","oneOfType","object","string","number","func","defaultProps","create","flexDirection","backgroundColor","alignItems","paddingVertical","textAlign","position","right","zIndex","indicatorTarget"],"mappings":"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","file":"RXScrollPicker.js","sourcesContent":["/**\n *\n * 参考：\n *  beeshell - ScrollPicker -->  https://github.com/Meituan-Dianping/beeshell\n * @flow\n */\n\"use strict\"\nimport React, { Component } from \"react\"\nimport { StyleSheet, View, Text, PixelRatio, ScrollView } from \"react-native\"\n\nimport PropTypes from 'prop-types'\nimport { RXConfigArray } from '../../utils/RXUtils'\nimport RXPickerStyle from '../RXPickerStyle'\n\nconst px = 1 / PixelRatio.get();\nconst DEFAULT_CONTAINER_HEIGHT = 1;\n\nconst variables = {\n  mtdBorderColorDark: RXPickerStyle.store.mtdBorderColorDark || \"#e5e5e5\",\n  mtdVSpacingL: RXPickerStyle.store.mtdVSpacingL || 10,\n};\n\nexport default class RXScrollPicker extends Component {\n  static propTypes = {\n    ...View.propTypes,\n    // 选择数据源，二维数组，第一层代表列，第二层代表选择项，选择项数据可以是对象（必须包含 label 属性）或者 string、number\n    list: PropTypes.arrayOf(\n      PropTypes.arrayOf(\n        PropTypes.oneOfType([\n          PropTypes.element,\n          PropTypes.object,\n          PropTypes.string,\n          PropTypes.number,\n        ])\n      )\n    ),\n    // 选中的数据，一维数组，数组索引代表 list 列，数组值对应 list 行，所以其长度要和数据源 list 长度一致\n    value: PropTypes.arrayOf(PropTypes.number),\n    // 分区比例，注意和数据源长度保持一致\n    proportion: PropTypes.arrayOf(PropTypes.number),\n    // 选中项距离顶部的偏移个数\n    offsetCount: PropTypes.number,\n    // 自定义渲染项\n    renderItem: PropTypes.func,\n    // 数据变化回调，该函数提供两个索引参数，第一个是列索引，第二个是行索引\n    onChange: PropTypes.func,\n  };\n\n  static defaultProps = {\n    ...View.defaultProps,\n    // renderItem: (e)=> { return null },\n    onChange: (scrollIndex = 0, targetItemIndex = 0) => { },\n  };\n\n  constructor(props) {\n    super(props);\n\n    const data = this.initialize(props);\n    this.state = {\n      ...data,\n      targetItemHeight: null,\n      containerHeight: null,\n    };\n    this.containerRef = null;\n    this.scrollers = [];\n    this.targetItemHeight = null;\n    this.containerHeight = null;\n    this.containerRef = null;\n  }\n\n  initialize(props) {\n    let { list, proportion, value } = props;\n    if (!list || !list.length) {\n      throw TypeError(\"提供有效的 list 参数\");\n    }\n    const { offsetCount } = this.props;\n    const placeholderList = RXConfigArray(offsetCount).map(() => {\n      return \"\";\n    });\n    list = list.map((scrollItem) => {\n      const tmp = scrollItem.concat();\n      [].push.apply(tmp, placeholderList);\n      [].unshift.apply(tmp, placeholderList);\n      return tmp;\n    });\n    const length = list.length;\n    if (\n      !proportion ||\n      !proportion.length ||\n      (proportion && proportion.length && proportion.length !== length)\n    ) {\n      proportion = RXConfigArray(length).map(() => {\n        return 1;\n      });\n    }\n    if (\n      !value ||\n      !value.length ||\n      (value && value.length && value.length !== length)\n    ) {\n      value = RXConfigArray(length).map(() => {\n        return 0;\n      });\n    }\n    return {\n      list,\n      value,\n      proportion,\n    };\n  }\n\n  componentDidMount() {\n    this.getUIData(this.containerRef, DEFAULT_CONTAINER_HEIGHT)\n      .then((data) => {\n        const { targetItemHeight } = data;\n        const containerHeight = this.resizeContainerHeight(targetItemHeight);\n        this.setState(\n          {\n            containerHeight,\n            targetItemHeight,\n          },\n          () => {\n            this.getUIData(this.containerRef, this.state.containerHeight)\n              .then((uiData) => {\n                const { value } = this.state;\n                value.forEach((item, index) => {\n                  this.scrollTo(index, item, false);\n                });\n              })\n              .catch((e) => {\n                console.log(e);\n              });\n          }\n        );\n      })\n      .catch((e) => {\n        console.log(e);\n      });\n  }\n\n  componentWillReceiveProps(nextProps) {\n    if (nextProps !== this.props) {\n      const data = this.initialize(nextProps);\n      this.setState(\n        {\n          ...data,\n        },\n        () => {\n          setTimeout(() => {\n            const { value } = this.state;\n            value.forEach((item, index) => {\n              this.scrollTo(index, item);\n            });\n          });\n        }\n      );\n    }\n  }\n\n  getUIData(element, accurateHeight, maxCount) {\n    let count = 0;\n    maxCount = maxCount == null ? 20 : maxCount;\n    return new Promise((resolve, reject) => {\n      let toCheck = null;\n      let measure = () => {\n        let ret = null;\n        element.measure((x, y, width, height, left, top) => {\n          // console.log(\n          //   `Get container height: ${height}, accurate height: ${accurateHeight} and target item height: ${\n          //     this.targetItemHeight\n          //   } for ${++count}th.`\n          // )\n          if (height) {\n            // 安卓机器获取高度不精确\n            const needToReset = height % 1 === 0 ? false : true;\n            let minHeight;\n            let maxHeight;\n            if (needToReset) {\n              minHeight = Math.floor(height);\n              maxHeight = minHeight + 1;\n            } else {\n              minHeight = maxHeight = height;\n            }\n            if (\n              (minHeight === accurateHeight || maxHeight === accurateHeight) &&\n              this.targetItemHeight\n            ) {\n              ret = {\n                rect: {\n                  x,\n                  y,\n                  width,\n                  height,\n                },\n                targetItemHeight: this.targetItemHeight,\n              };\n            }\n          }\n          toCheck(ret);\n        });\n      };\n      toCheck = (ret) => {\n        if (ret) {\n          return resolve(ret);\n        } else {\n          if (count < maxCount) {\n            setTimeout(() => {\n              measure();\n            }, 20);\n          } else {\n            return reject('获取元素高度失败！');\n          }\n        }\n      };\n      measure();\n    });\n  }\n\n  resizeContainerHeight(targetItemHeight) {\n    const { offsetCount } = this.props;\n    const ret = targetItemHeight + 2 * (targetItemHeight * offsetCount);\n    return ret;\n  }\n\n  locateIndicator(targetItemHeight) {\n    const { offsetCount } = this.props;\n    return React.createElement(\n      View,\n      {\n        style: [styles.indicator],\n        pointerEvents: 'none',\n      },\n      React.createElement(View, {\n        style: [\n          styles.indicator,\n          styles.indicatorMask,\n          {\n            bottom: targetItemHeight + offsetCount * targetItemHeight,\n          },\n          {\n            borderBottomWidth: 1 * px,\n            borderBottomColor: variables.mtdBorderColorDark,\n          },\n        ],\n      }),\n      React.createElement(View, {\n        style: [\n          styles.indicator,\n          styles.indicatorMask,\n          {\n            top: targetItemHeight + offsetCount * targetItemHeight,\n          },\n          {\n            borderTopWidth: 1 * px,\n            borderTopColor: variables.mtdBorderColorDark,\n          },\n        ],\n      })\n    );\n  }\n\n  scrollTo(scrollIndex, targetItemIndex, animated) {\n    const { targetItemHeight } = this.state;\n    // const { offsetCount } = this.props\n    this.scrollProper(\n      scrollIndex,\n      targetItemHeight * targetItemIndex,\n      animated\n    );\n  }\n\n  onScroll(scrollIndex, scrollHeight) {\n    const targetItemIndex = this.scrollProper(scrollIndex, scrollHeight);\n    this.props.onChange && this.props.onChange(scrollIndex, targetItemIndex);\n  }\n\n  scrollProper(scrollIndex, scrollHeight, animated) {\n    const { targetItemHeight, list } = this.state;\n    const { offsetCount } = this.props;\n    const scrollListLength = list[scrollIndex].length;\n    let newScrollHeight;\n    const min = 0;\n    const max = (scrollListLength - 2 * offsetCount - 1) * targetItemHeight;\n    if (scrollHeight <= min) {\n      newScrollHeight = min;\n    } else if (scrollHeight >= max) {\n      newScrollHeight = max;\n    } else {\n      const quotient = parseInt(String(scrollHeight / targetItemHeight), 10);\n      newScrollHeight = quotient * targetItemHeight;\n      const halfHeight = targetItemHeight / 2;\n      if (scrollHeight - newScrollHeight > halfHeight) {\n        newScrollHeight += targetItemHeight;\n      }\n    }\n    this.scrollers[scrollIndex] &&\n      this.scrollers[scrollIndex].scrollTo &&\n      this.scrollers[scrollIndex].scrollTo({\n        x: 0,\n        y: newScrollHeight,\n        animated: animated === false ? false : true,\n      });\n    const targetItemIndex = newScrollHeight / targetItemHeight;\n    return targetItemIndex;\n  }\n\n  render() {\n    const { list, proportion, containerHeight, targetItemHeight } = this.state;\n    return React.createElement(\n      View,\n      {\n        ref: (el) => {\n          this.containerRef = el;\n        },\n        style: [\n          styles.container,\n          this.props.contentStyle,\n          {\n            height: containerHeight || DEFAULT_CONTAINER_HEIGHT,\n          },\n        ],\n      },\n      containerHeight && this.locateIndicator(targetItemHeight),\n      list.map((scrollItem, scrollIndex) => {\n        return React.createElement(\n          View,\n          {\n            key: scrollIndex,\n            style: [\n              styles.proportionWrapper,\n              {\n                flex: Number(proportion[scrollIndex]),\n              },\n            ],\n          },\n          React.createElement(\n            ScrollView,\n            {\n              ref: (c) => {\n                this.scrollers[scrollIndex] = c;\n              },\n              style: styles.scroller,\n              scrollEventThrottle: 20,\n              showsVerticalScrollIndicator: false,\n              contentContainerStyle: [styles.scrollerContentContainer],\n              // onScrollEndDrag: (e) => { // 由于 react-native-web 版本不同，有的不支持\n              //   this.onScroll(scrollIndex, e.nativeEvent.contentOffset.y);\n              // },\n              onScroll: (e) => {\n                this.onScroll(scrollIndex, e.nativeEvent.contentOffset.y);\n              },\n            },\n            scrollItem.map((item, index) => {\n              return React.createElement(\n                View,\n                {\n                  key: index,\n                  style: [\n                    styles.targetItem,\n                    {\n                      height: targetItemHeight,\n                    },\n                  ],\n                  onLayout: (e) => {\n                    if (\n                      item &&\n                      this.targetItemHeight == null &&\n                      e.nativeEvent.layout.height\n                    ) {\n                      this.targetItemHeight = Math.ceil(\n                        e.nativeEvent.layout.height\n                      );\n                      // console.log(\n                      //   'OnLayout get target item height:',\n                      //   this.targetItemHeight\n                      // )\n                    }\n                  },\n                },\n                this.props.renderItem\n                  ? this.props.renderItem(item, index)\n                  : React.createElement(\n                    Text,\n                    {\n                      style: [styles.targetItemContent],\n                      numberOfLines: 1,\n                    },\n                    typeof item === 'object' ? item.label : item\n                  )\n              );\n            })\n          )\n        );\n      })\n    );\n  }\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flexDirection: 'row',\n    backgroundColor: '#fff',\n  },\n  proportionWrapper: {\n    flexDirection: 'column',\n  },\n  scroller: {\n    flex: 1,\n  },\n  scrollerContentContainer: {\n    alignItems: 'center',\n  },\n  targetItem: {\n    flexDirection: 'row',\n    alignItems: \"center\",\n  },\n  targetItemContent: {\n    flex: 1,\n    paddingVertical: variables.mtdVSpacingL,\n    textAlign: \"center\",\n  },\n  indicator: {\n    position: \"absolute\",\n    top: 0,\n    bottom: 0,\n    left: 0,\n    right: 0,\n    zIndex: 1,\n  },\n  indicatorMask: {\n    backgroundColor: \"rgba(255, 255, 255, 0.75)\",\n  },\n  indicatorTarget: {},\n});\n"]}