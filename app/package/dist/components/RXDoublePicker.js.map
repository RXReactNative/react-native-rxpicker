{"version":3,"sources":["../../src/components/RXDoublePicker.js"],"names":["React","Component","PropTypes","RXPicker","RXDoublePicker","constructor","props","onChange","scrollIndex","targetItemIndex","resultIndexArray","onConfirm","list","length","console","warn","resultArray","i","index","array","push","value","getValue","selectValue","valueKey","item","getDoubleValue","selectValues","Array","isArray","render","style","other","emptyArray","lastList","proportionArray","valueArray","concat","paddingBottom","propTypes","arrayOf","oneOfType","object","number","string","defaultProps"],"mappings":"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","file":"RXDoublePicker.js","sourcesContent":["/**\n *\n *\n * @flow\n */\n'use strict'\nimport React, { Component } from 'react';\nimport { } from 'react-native';\nimport PropTypes from 'prop-types';\n\nimport RXPicker from '../core/RXPicker';\n\nexport default class RXDoublePicker extends Component {\n  static propTypes = {\n    ...RXPicker.propTypes,\n    selectValues: PropTypes.arrayOf(\n      PropTypes.oneOfType([\n        PropTypes.object,\n        PropTypes.number,\n        PropTypes.string,\n      ])\n    ),\n    valueKey: PropTypes.string,\n  }\n\n  static defaultProps = {\n    ...RXPicker.defaultProps,\n    list: [],\n  }\n\n  constructor(props) {\n    super(props);\n\n    this.resultIndexArray = [0, 0];\n  }\n\n  getValue(index = 0, list = [], selectValue = null, valueKey = null) {\n    if (!selectValue) return null;\n    if (typeof selectValue === 'string' || typeof selectValue === 'number') {\n      for (let i = 0; i < list.length; i++) {\n        const item = list[i] || '';\n        if (item === selectValue) {\n          this.resultIndexArray[index] = i || 0;\n          return i;\n        }\n      }\n      return 0;\n    }\n    else if (typeof selectValue === 'object' && valueKey) {\n      for (let i = 0; i < list.length; i++) {\n        const item = list[i] || {};\n        const value = item[valueKey];\n        if (value === selectValue) {\n          this.resultIndexArray[index] = i || 0;\n          return i;\n        }\n      }\n      return 0;\n    }\n  }\n\n  getDoubleValue() {\n    const props = this.props || {}\n    const selectValues = props.selectValues;\n    const valueKey = props.valueKey;\n    const list = props.list || [];\n    if (!Array.isArray(selectValues)) return null;\n    const value = [];\n    for (let i = 0; i < list.length; i++) {\n      const array = list[i] || [];\n      if (selectValues.length > i) {\n        const selectValue = selectValues[i];\n        value.push(this.getValue(i, array, selectValue, valueKey));\n      }\n      else {\n        value.push(0)\n        this.resultIndexArray[i] = 0;\n      }\n    }\n    return value;\n  }\n\n  onChange = (scrollIndex = 0, targetItemIndex = 0) => {\n    const { onChange } = this.props;\n    // console.log('onChange=> scrollIndex='+scrollIndex+',,,targetItemIndex='+targetItemIndex);\n    this.resultIndexArray[scrollIndex - 1] = targetItemIndex;\n    onChange && onChange(scrollIndex, targetItemIndex);\n  }\n\n  onConfirm = () => {\n    let { list, onConfirm } = this.props;\n    list = list || [];\n    if (!this.resultIndexArray || this.resultIndexArray.length > list.length) {\n      console.warn('RXDoublePicker 数组越界');\n      return;\n    }\n    const length = this.resultIndexArray.length;\n    const resultArray = [];\n    for (let i = 0; i < length; i++) {\n      const index = this.resultIndexArray[i] || 0;\n      const array = list[i] || [];\n      if (index > array.length) {\n        console.warn('RXDoublePicker 数组越界');\n        resultArray.push('');\n      }\n      else {\n        const value = array[index];\n        resultArray.push(value);\n      }\n    }\n    onConfirm && onConfirm(resultArray);\n  }\n\n  render() {\n    const { style, list, ...other } = this.props;\n    const value = this.getDoubleValue();\n    // 前后的 空数组 处理\n    const emptyArray = [];\n    const lastList = [emptyArray];\n    const proportionArray = [1];\n    const valueArray = ([0].concat(value)).concat(0);\n    for (let i = 0; i < list.length; i++) {\n      const array = list[i] || [];\n      lastList.push(array);\n      proportionArray.push(1);\n    }\n    lastList.push(emptyArray)\n    proportionArray.push(1);\n\n    return <RXPicker\n      {...other}\n      style={[{ paddingBottom: 20 }, style]}\n\n      // 数据源\n      list={lastList}\n\n      // 选中的\n      value={valueArray}\n\n      // 分区比例，注意和list数据源长度保持一致 (如果一致的，可以不写)\n      proportion={proportionArray}\n      // 选中项距离顶部的偏移个数\n      offsetCount={2}\n      onChange={this.onChange}\n      onConfirm={this.onConfirm}\n    />\n  }\n}"]}